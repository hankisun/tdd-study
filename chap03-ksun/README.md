
# CH3

## Summary

### 구현하기 쉬운 테스트부터 시작하기
한 번에 많은 코드를 만들면 버그 발생 확률이 높아짐
예 - 모든 조건 충족 또는 모든 조건 미충족 부터 TC작성 시작

### 예외 상황을 먼저 테스트
나중에 반영할 때보다 코드 구조가 덜 바뀜

### 점진적 구현
한 번에 얼마만큼의 코드를 작성할 것인가?
- 정해진 값을 리턴
- 값 비교를 이용하여 정해진 값을 리턴
- 다양한 테스트를 추가하면서 구현을 일반화

### 지속적인 리팩토링
- 코드 중복, 변수명 변경 등 작은 리팩토링은 수시로 수행
- 메서드 추출, 구조변경
	- 구현 흐름이 어느 정도 잡힌 경우에 수행

> **Note**
> - 동작하는 코드를 만드는 능력
> - 코드를 잘 변경할 수 있는 능력

### TDD 가이드 - 쉬운 것부터 테스트
- 구현하기 쉬운 것부터 먼저 테스트
- 예외 상황을 먼저 테스트
- 테스트 과정에서 새로운 테스트 사례를 계속 발견할 수 있으며, 목록에 추가해놓고 놓치지 않아야 함
- 짧은 리듬 - 하나의 테스트 코드 구현, 리팩토링, 다음 테스트 코드 구현, 리팩토링, ...
- 범위가 큰 리팩토링인 경우,
	- 시간이 오래 걸리므로 TDD 흐름을 깨기 쉽다. 테스트를 통화하는 데에 먼저 집중하고, 추후에 진행하는 것을 추천
- 테스트 코드 작성이 잘 안될 때엔
	- assert 코드부터 작성하면서, 확장해 나가는 방식이 도움이 됨
- 구현이 막히면
	- 과감하게 코드를 지우고 미련없이 다시 시작

## Practice

### 구현 항목 - 서비스 만료일 산출
1. 서비스를 사용하려면 매달 1만원을 선불로 납부해야 하며, 납부일 기준 한 달 뒤가 서비스 만료일
2. 2개월 이상 요금 납부 가능
3. 10만원 납부 시 서비스를 1년 제공

### TestCase 추가 / 구현 일반화(구현항목 1)
- 만원 납부 후 한달 뒤 만료
### 코드정리:중복제거
- 테스트 메서드가 테스트하는 바를 명확하게 설명할 수 있어야 함
### 예외 TestCase 추가
- 납부일이 2019-01-31이고 납부액이 1만원이면 만료일은 2019-02-28
- 납부일이 2019-05-31이고 납부액이 1만원이면 만료일은 2019-06-30
- 납부일이 2020-01-31이고 납부액이 1만원이면 만료일은 2020-02-29
### TestCase 추가(구현항목 2) 설계
- 2만원 지불 시 만료일은 두 달 뒤
	- 첫 납부일이 2019-01-31이고 만료되는 2019-02-28에 1만원을 납부하면, 다음 만료일은 2019-03-31 이다
	- 첫 납부일이 2019-01-30이고 만료되는 2019-02-28에 1만원을 납부하면, 다음 만료일은 2019-03-30 이다
	- 첫 납부일이 2019-05-31이고 만료되는 2019-06-30에 1만원을 납부하면, 다음 만료일은 2019-07-31 이다
- 3만원 지불 시 만료일은 세 달 뒤

> **Note**
> '첫 납부일' 추가 필요
### 리팩토링
- `calculateExpiryDate` 메서드의 파라미터로 첫 납부일 추가
- 첫 납부일, 납부일, 납부액을 담은 객체를 `calculateExpiryDate` 메서드에 전달

> - 파라미터 개수는 적을수록 코드 가독성과 유지보수에 유리하므로, 파라미터를 객체로 바꿔 전달하도록 리팩토링
> - PayData 클래스 생성
### TestCase 추가(구현항목 2)
- 2만원을 지불하면 만료일이 두 달 뒤가 된다.
- 3만원을 지불하면 만료일이 석 달 뒤가 된다.

### 예외 TestCase 추가
- 첫 납부일이 2019-01-31 이고 만료되는 2019-02-28에 2만원을 납부하면 다음 만료일은 2019-04-30이다
	- 후보 만료월 마지막 날 < 첫 납부일의 일자
### 코드정리
- 날짜 계산 코드 중복 제거
- 첫 납부일의 일자 코드 중복 제거
- 구조 가 한 눈에 보이도록 정리
### TestCase 추가(구현항목 3)
- 10개월 요금 납부 시 1년 서비스 제공
	- 지불 금액으로 판단
### 예외 TestCase 추가
- 2020.2.29 윤달에 10만원 납부 시, 만료일은 2021.02.28
- 13만원 납부 시, 만료일은 1년 3개월 뒤

